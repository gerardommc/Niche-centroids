cols <- viridis::viridis(4)
rgl.init()
with(dat.skew.sep, plot3d(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
colors = rep(cols, each = 2500)))
rep(cols, each = 2500)
rgl.spheres(x, y, z, col = "moccasin", alpha = 0.5,
xlab = "", ylab = "", zlab = "")
rgl.spheres(x, y, z, col = "moccasin", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.01)
rgl.spheres(x, y, z, col = "moccasin", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1)
rgl.init()
with(dat.skew.sep, rgl.spheres(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
get_colors(centr.conf), r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
get_colors(centr.conf), r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
colors = get_colors(centr.conf), r = 0.01))
cols <- c("orangered",
"paleturquiose4",
"pink",
"peachpuff")
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
colors = rep(cols, each = 2500), r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500), r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = "orangered", r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = "paleturquoise4", r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = "paleturquoise4", r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = "pink", r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = "pink", r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = "peachpuff", r = 0.01))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = cols))
cols <- c("orangered",
"paleturquiose3",
"pink",
"peachpuff")
rgl.init()
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = ))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = cols))
cols <- c("orangered",
"pink4",
"pink",
"peachpuff")
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = cols))
cols <- c("orangered",
"seagreen4",
"pink",
"peachpuff")
rgl.init()
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = cols))
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.init()
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.init()
rgl.bg(color = "white")
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.bbox()
rgl.init()
rgl.bg(color = "white")
with(dat.skew.sep, rgl.points(x = corr.ppm, y = corr.ell, z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.surface(x, y, z, col = "grey", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1)
rgl.init()
rgl.bg(color = "white")
with(dat.skew.sep, rgl.points(x = corr.ell, y = corr.ppm, z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.surface(x, y, z, col = "grey", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1)
persp3d(x, y, z, col = "grey", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1)
with(dat.skew.sep, rgl.points(x = corr.ell, y = corr.ppm, z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
persp3d(x, y, z, col = "grey", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.texts(x = c(0.05, 0.05, 0.05), y = c(0.9, 0.9, 0.9), z = c(-2.2, -1.7, - 1.2),
text = levels(as.factor(dat.skew.sep)))
rgl.texts(x = c(0.5, 0.5, 0.5), y = c(0.9, 0.9, 0.9), z = c(-2.2, -1.7, - 1.2),
text = levels(as.factor(dat.skew.sep)))
rgl.texts(x = c(0.9, 0.9, 0.9), y = c(-0.5, -0.5, -0.5) , z = c(-2.2, -1.7, - 1.2),
text = levels(as.factor(dat.skew.sep)))
rgl.texts(x = c(0.9, 0.9, 0.9), y = c(-0.5, -0.5, -0.5) , z = c(-2.2, -1.7, - 1.2),
text = levels(as.factor(dat.skew.sep$centr.conf)))
levels(as.factor(dat.skew.sep$centr.conf))
rgl.snapshot("../Graphs/Corr-both-vs-distance", fmt = "png", width = 2000, height = 2000)
rgl.snapshot("../Graphs/Corr-both-vs-distance", fmt = "png")
1980/1080
rgl.snapshot("../Graphs/Corr-both-vs-distance", fmt = "png", webshot = T)
rgl.postscript("../Graphs/Corr-both-vs-distance", fmt = "eps", )
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
persp3d(x, y, z, col = "grey", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
persp3d(x, y, z, col = "grey90", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
persp3d(x, y, z, col = "grey95", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
persp3d(x, y, z, col = "grey95", alpha = 0.5,
xlab = "PPM", ylab = "MVE", zlab = expression(paste0("MVE ", log[10], " Distance")), r = 0.1, cex.axis = 2)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
persp3d(x, y, z, col = "grey95", alpha = 0.5,
xlab = "PPM", ylab = "MVE", zlab = expression(paste("MVE ", log[10], " Distance")), r = 0.1, cex.axis = 2)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
persp3d(x, y, z, col = "grey95", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
persp3d(x, y, z, col = "grey99", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
ggplot(dat.skew.sep) + geom_hex(aes(x = corr.ppm, y = corr.ell)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ppm), y = log10(dist.ell))) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ppm), y = corr.ell)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = corr.ppm, y =log10(dist.ell))) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ppm), y = corr.ppm)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ell), y = corr.ell)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = corr.ppm, y = corr.ell)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ppm), y = log10(dist.ell))) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ppm), y = corr.ell)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = corr.ppm, y =log10(dist.ell))) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ppm), y = corr.ppm)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ell), y = corr.ell)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ppm), y = corr.ppm)) +
geom_smooth(aes(x = log10(dist.ppm), y = corr.ppm), colour = "red") +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew) + geom_hex(aes(x = log10(dist.ppm), y = corr.ppm)) +
geom_smooth(aes(x = log10(dist.ppm), y = corr.ppm), colour = "red") +
facet_grid(rows = vars(method), cols = vars(centr.conf))
names(dat.skew)
ggplot(dat.skew) + geom_hex(aes(x = log10(dist.ppm), y = corr.ppm)) +
geom_smooth(aes(x = log10(dist.ppm), y = corr.ppm), colour = "red") +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
ggplot(dat.skew) + geom_hex(aes(x = log10(Disttrue.cent), y = Corr.surf)) +
geom_smooth(aes(x = log10(dist.ppm), y = corr.ppm), colour = "red") +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
ggplot(dat.skew) + geom_hex(aes(x = log10(Dist.true.cent), y = Corr.surf)) +
geom_smooth(aes(x = log10(dist.ppm), y = corr.ppm), colour = "red") +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
ggplot(dat.skew) + geom_hex(aes(x = log10(Dist.true.cent), y = Corr.surf)) +
geom_smooth(aes(x = log10(Dist.true.cent), y = Corr.surf), colour = "red") +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
ggplot(dat.skew) + geom_hex(aes(x = log10(Dist.true.cent), y = Corr.surf)) +
geom_smooth(aes(x = log10(Dist.true.cent), y = Corr.surf), colour = "red", method = "lm") +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
ggplot(dat.skew) + geom_hex(aes(x = log10(Dist.true.cent), y = Corr.surf)) +
geom_smooth(aes(x = log10(Dist.true.cent), y = Corr.surf), colour = "red", method = "loess") +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
ggplot(dat.skew) + geom_hex(aes(x = log10(Dist.true.cent), y = Corr.surf)) +
geom_smooth(aes(x = log10(Dist.true.cent), y = Corr.surf), colour = "red", method = "gam") +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
ggplot(dat.skew) + geom_hex(aes(x = log10(Dist.true.cent), y = Corr.surf)) +
geom_smooth(aes(x = log10(Dist.true.cent), y = Corr.surf), colour = "red", method = "gam", alpha = 0.3) +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
ggplot(dat.skew) + geom_hex(aes(x = log10(Dist.true.cent), y = Corr.surf)) +
geom_smooth(aes(x = log10(Dist.true.cent), y = Corr.surf), colour = "red", method = "gam", alpha = 0.3) +
scale_fill_continuous(type = "viridis", trans = "log10") +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
pdf("../Graphs/Dist-vs-corr-surfs.pdf", width = 9, height = 4)
ggplot(dat.skew) + geom_hex(aes(x = log10(Dist.true.cent), y = Corr.surf)) +
geom_smooth(aes(x = log10(Dist.true.cent), y = Corr.surf), colour = "red", method = "gam", alpha = 0.3) +
scale_fill_continuous(type = "viridis", trans = "log10") +
facet_grid(rows = vars(approach), cols = vars(centr.conf))
dev.off()
library(data.table); library(doParallel); library(reshape)
library(raster); library(ggplot2)
#Analysis of models
ppms <- rbindlist(lapply(list.files("Simulated-species", "PPMs", full.names = T), read.csv))
ellips <-  rbindlist(lapply(list.files("Simulated-species", "llipses", full.names = T), read.csv))
all.results <- rbind(ppms, ellips)
#Model subsets
ppms.sat <- subset(ppms, approach == "PPM-sat")
ppms.sat.norm <- subset(ppms, approach == "PPM-sat-NORM")
ppms.step <- subset(ppms, approach == "PPM-step")
ellips.norm <- subset(ellips, approach == "Ellipses-NORM")
ellips <- subset(ellips, approach == "Ellipses")
corr.dif.sat <- ppms.sat$Corr.surf - ellips$Corr.surf
dist.dif.sat <- ellips$Dist.true.cent - ppms.sat$Dist.true.cent
#Environmental layers
all.layers <- readRDS("Simulated-layers/All-simulated-layers.rds")
all.layers.norm <- readRDS("Simulated-layers/All-simulated-layers-NORM.rds")
config <- lapply(paste0("Simulated-species/Sim-config-species-list",
c("", "-EdgeCentroids",
"-OuterCentroids",
"-RandomCentroids"), ".rds"), readRDS)
library(foreach)
bimod <- lapply(1:nlayers(all.layers), function(x){diptest::dip.test(all.layers[[x]][])})
bimod.norm <- lapply(1:nlayers(all.layers.norm), function(x){diptest::dip.test(all.layers.norm[[x]][])})
spp.layers <- foreach(k = 1:ncol(config[[1]]$layers)) %do% {
dropLayer(all.layers, i = c(which(! 1:nlayers(all.layers) %in% config[[1]]$layers[, k])))
}
spp.layers.norm <- foreach(k = 1:ncol(config[[1]]$layers)) %do% {
dropLayer(all.layers.norm, i = c(which(! 1:nlayers(all.layers.norm) %in% config[[1]]$layers[, k])))
}
comp.bimod <- foreach(k = 1:ncol(config[[1]]$layers), .combine = c) %do% {
b <- bimod[c(which(1:nlayers(all.layers) %in% config[[1]]$layers[, k]))]
sum(sapply(b, function(x){x$statistic}))
}
comp.bimod.norm <- foreach(k = 1:ncol(config[[1]]$layers), .combine = c) %do% {
b <- bimod.norm[c(which(1:nlayers(all.layers.norm) %in% config[[1]]$layers[, k]))]
sum(sapply(b, function(x){x$statistic}))
}
pres <- lapply(paste0("Simulated-species/Species-presences",
c(".rds",
"-EdgeCentroids.rds",
"-OuterCentroids.rds",
"-RandomCentroids.rds")), readRDS)
#Skewness analyses
registerDoParallel(cores = 4)
s <- seq(1, 10000, by = 4) #Sample of the environment
env.skew <- foreach(i = seq_along(spp.layers), .combine = c) %dopar% {
df <- as.matrix(spp.layers[[i]])[s, ]
res <- MVN::mvn(df, mvnTest = "hz", multivariatePlot = F)$multivariateNormality$HZ
return(res)
}
env.skew.norm <- foreach(i = seq_along(spp.layers.norm), .combine = c) %dopar% {
df <- as.matrix(spp.layers.norm[[i]])[s, ]
res <- MVN::mvn(df, mvnTest = "hz", multivariatePlot = F)$multivariateNormality$HZ
return(res)
}
#Adding the analyses to model data
ppms.sat$Skewness.env <- rep(env.skew, 4)
ppms.sat.norm$Skewness.env <- rep(env.skew.norm, 4)
ppms.step$Skewness.env <- rep(env.skew, 4)
ellips$Skewness.env <-  rep(env.skew, 4)
ellips.norm$Skewness.env <-  rep(env.skew.norm, 4)
ppms.sat$bimod <-rep(comp.bimod, 4)
ppms.sat.norm$bimod <- rep(comp.bimod.norm, 4)
ppms.step$bimod <- rep(comp.bimod, 4)
ellips$bimod <- rep(comp.bimod, 4)
ellips.norm$bimod <- rep(comp.bimod.norm, 4)
dat.skew <- rbind(ppms.sat, ellips)
dat.skew.norm <- rbind(ppms.sat.norm, ellips.norm)
dat.skew.all <- rbind(dat.skew, dat.skew.norm)
dat.skew.ppm <- subset(dat.skew, approach == "PPM-sat")
dat.skew.ellip <- subset(dat.skew, approach == "Ellipses")
dat.skew.sep <- data.frame(
centr.conf = dat.skew.ppm$centr.conf,
corr.ppm = dat.skew.ppm$Corr.surf,
corr.ell = dat.skew.ellip$Corr.surf,
dist.ppm = dat.skew.ppm$Dist.true.cent,
dist.ell = dat.skew.ellip$Dist.true.cent
)
ggplot(dat.skew.sep) + geom_hex(aes(x = corr.ppm, y = corr.ell)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ppm), y = log10(dist.ell))) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ppm), y = corr.ell)) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = corr.ppm, y =log10(dist.ell))) +
facet_grid(cols = vars(centr.conf))
ggplot(dat.skew.sep) + geom_hex(aes(x = log10(dist.ell), y = corr.ell)) +
facet_grid(cols = vars(centr.conf))
library(rgl)
with(dat.skew.sep, plot3d(x = corr.ppm, y = corr.ell, z = log10(dist.ell)))
library(mgcv)
m1 <- gam(log10(dist.ell) ~ s(corr.ppm, corr.ell), data = dat.skew.sep)
new.data <-  expand.grid(corr.ppm = with(dat.skew.sep, seq(min(corr.ppm), max(corr.ppm), len = 25)),
corr.ell = with(dat.skew.sep, seq(min(corr.ell), max(corr.ell), len = 25)))
preds <- predict.gam(m1, newdata = new.data)
z <- matrix(preds, 25, 25)
x <- with(dat.skew.sep, seq(min(corr.ppm), max(corr.ppm), len = 25))
y <- with(dat.skew.sep, seq(min(corr.ell), max(corr.ell), len = 25))
cols <- c("orangered",
"seagreen4",
"pink",
"peachpuff")
rep(cols, each = 2500)
persp3d(x, y, z, col = "grey99", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
material3d(shininess = 0)
persp3d(x, y, z, col = "grey99", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
material3d(shininess = 0)
persp3d(x, y, z, col = "grey99", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
material3d(shininess = 0, lwd = 2)
persp3d(x, y, z, col = "grey99", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
material3d(shininess = 0, lwd = 2)
persp3d(x, y, z, col = "lightblue", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
material3d(shininess = 0, lwd = 2)
persp3d(x, y, z, col = "lightblue", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
material3d(shininess = 0, lwd = 2, front = "fill")
persp3d(x, y, z, col = "lightblue", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
material3d(shininess = 100, lwd = 2, front = "fill")
persp3d(x, y, z, col = "lightblue", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
material3d(shininess = 0, lwd = 2, front = "fill")
persp3d(x, y, z, col = "lightblue", alpha = 0.5,
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
material3d(shininess = 0, lwd = 2, front = "fill")
material3d(shininess = 0, lwd = 2, front = "fill")
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2)
material3d(shininess = 0, lwd = 2, front = "fill")
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 0)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 100)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 5)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 5, front = "fill")
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 5, back = "fill")
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 5, back = "fill", front = "fill")
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 5, back = NULL, front = "fill")
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 5, back = NULL, front = NULL)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 5, lit = F)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 10, lit = F, )
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, )
lines3d(x, y, z)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, )
persp3d(x, y, z, ytpe = "wire", add = T)
persp3d(x, y, z, type = "wire", add = T)
persp3d(x, y, z, type = "wire", add = T, col = "black")
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, )
persp3d(x, y, z, type = "wire", add = T, col = "black")
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, )
persp3d(x, y, z, type = "wire", add = T, col = "black")
plot3d(x, y, z, type = "wire", add = TRUE, col = "black")
plot3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, )
new.data$preds <- predict.gam(m1, newdata = new.data)
z <- matrix(new.data$preds, 25, 25)
x <- with(dat.skew.sep, seq(min(corr.ppm), max(corr.ppm), len = 25))
y <- with(dat.skew.sep, seq(min(corr.ell), max(corr.ell), len = 25))
with(new.data,
plot3d(corr.ppm, corr.ell, preds, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, ))
with(new.data,
plot3d(corr.ppm, corr.ell, preds, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, type = "l"))
with(new.data,
plot3d(corr.ppm, corr.ell, preds, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, type = "wire"))
with(new.data,
plot3d(corr.ppm, corr.ell, preds, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, type = "wire"))
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, )
wire3d(x, y, z, add = TRUE, col = "black")
wire3d(x, y, z, col = "black")
wire3d(new.data$corr.ppm, new.data$corr.ell, new.data$preds, col = "black")
?wire3d
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
cols <- viridis(4)
cols <- viridis::viridis(4)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black",
specular = "black")
wire3d(pers, col = "black", lit = F)
pers <- persp3d(x, y, z)
wire3d(pers, col = "black", lit = F)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black",
specular = "black")
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
shade3d(pers, col = "black", lit = F)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
persp3d(x, y, z, front = "lines", back = "lines",  col = "black", lit = F)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
persp3d(x, y, z, front = "lines", back = "lines",  col = "black", lit = F, add = T)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
persp3d(x, y, z, front = "lines",
back = "lines",  col = "black",
lwd = 3,lit = F, add = T)
persp3d(x, y, z, front = "lines",
back = "lines",  col = "black",
lwd = 2,lit = F, add = T)
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
persp3d(x, y, z, front = "lines",
back = "lines",  col = "black",
lwd = 2,lit = F, add = T)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
persp3d(x, y, z, front = "lines",
back = "lines",  col = "black",
lwd = 2.5,lit = F, add = T)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
persp3d(x, y, z, front = "lines",
back = "lines",  col = "black",
lwd = 1,lit = F, add = T)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
persp3d(x, y, z, front = "lines",
back = "lines",  col = "black",
lwd = 0.75,lit = F, add = T)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
persp3d(x, y, z, col = "lightblue",
xlab = "", ylab = "", zlab = "", r = 0.1, cex.axis = 2,
shininess = 50, lwd = 1, lit = F, meshColor = "black")
persp3d(x, y, z, front = "lines",
back = "lines",  col = "black",
lwd = 0.75,lit = F, add = T, smooth = T)
with(dat.skew.sep, rgl.points(x = corr.ppm, y =corr.ell , z = log10(dist.ell), add = T, alpha = 0.5,
col = rep(cols, each = 2500)))
rgl.postscript("../Graphs/Corr-both-vs-distance.pdf", "pdf", )
